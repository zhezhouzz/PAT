val ( == ) : 'a -> 'a -> bool
val ( > ) : int -> int -> bool
val eAssign : < id : int ; node : tNode > [@@gen]
val eNominate : < id : int ; node : tNode > [@@gen]
val eWon : < id : int ; node : tNode > [@@gen]

let eWakeUp ?l:(i = (true : [%v: int])) ?l:(n = (true : [%v: tNode])) =
  (allA, EWakeUp (id == i && node == n), [| ENominate (va == x) |])

let eNominate =
  [|
    (fun ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node1" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp (id == i && node == ("Node2" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| EWon (va == x) |] ));
    (fun ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node2" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp (id == i && node == ("Node3" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| EWon (va == x) |] ));
    (fun ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node3" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp (id == i && node == ("Node1" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| EWon (va == x) |] ));
    (fun ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node1" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp ((not (id > i)) && (not (id == i)) && node == ("Node2" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| ENominate (id == i && node == ("Node2" : tNode)) |] ));
    (fun ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node2" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp ((not (id > i)) && (not (id == i)) && node == ("Node3" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| ENominate (id == i && node == ("Node3" : tNode)) |] ));
    (fun ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node3" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp ((not (id > i)) && (not (id == i)) && node == ("Node1" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| ENominate (id == i && node == ("Node1" : tNode)) |] ));
    (fun (j : int) ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node1" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp (id == j && id > i && node == ("Node2" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| ENominate (id == j && node == ("Node2" : tNode)) |] ));
    (fun (j : int) ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node2" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp (id == j && id > i && node == ("Node3" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| ENominate (id == j && node == ("Node3" : tNode)) |] ));
    (fun (j : int) ?l:(i = (true : [%v: int]))
         ?l:(n = (v == ("Node3" : tNode) : [%v: tNode])) ->
      ( (allA;
         EWakeUp (id == j && id > i && node == ("Node1" : tNode));
         allA),
        ENominate (id == i && node == n),
        [| ENominate (id == j && node == ("Node1" : tNode)) |] ));
  |]

let eWon ?l:(i = (true : [%v: int])) ?l:(n = (true : [%v: tNode])) =
  (allA, eWon (id == i && node == n), [||])

let[@goal] uniqueLeader (n : tNode) =
  not
    (allA;
     EWon (node == n);
     allA;
     EWon (not (node == n));
     allA)
